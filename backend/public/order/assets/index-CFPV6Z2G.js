import{r as e,a as t,R as r}from"./vendor-BXk_ma1u.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var s={exports:{}},i={},l=e,a=Symbol.for("react.element"),n=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,d=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function m(e,t,r){var s,i={},l=null,n=null;for(s in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(n=t.ref),t)o.call(t,s)&&!c.hasOwnProperty(s)&&(i[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===i[s]&&(i[s]=t[s]);return{$$typeof:a,type:e,key:l,ref:n,props:i,_owner:d.current}}i.Fragment=n,i.jsx=m,i.jsxs=m,s.exports=i;var h=s.exports,x={},p=t;x.createRoot=p.createRoot,x.hydrateRoot=p.hydrateRoot;async function u(e,t={}){var r;const s=await fetch(`/api${e}`,{headers:{"Content-Type":"application/json",...t.headers},...t});if(!s.ok){const e=await s.json().catch(()=>({})),t=e.message??(null==(r=Object.values(e.errors??{})[0])?void 0:r[0])??"Request failed";throw new Error(t)}return await s.json()}async function f(){return u("/categories")}async function y(){return u("/items?available_only=1")}async function g(e){return u("/customer/orders",{headers:{Authorization:`Bearer ${e}`}})}function j(){const[t,r]=e.useState([]),[s,i]=e.useState([]),[l,a]=e.useState(null),[n,o]=e.useState(null),[d,c]=e.useState([]),[m,x]=e.useState([]),[p,j]=e.useState(""),[b,v]=e.useState(""),[N,k]=e.useState(()=>localStorage.getItem("online_token")),[S,w]=e.useState(null),[C,_]=e.useState([]),[z,M]=e.useState(""),[O,R]=e.useState(""),[B,P]=e.useState(!1),[I,A]=e.useState(null),[F,T]=e.useState(""),[W,D]=e.useState(!1);e.useEffect(()=>{Promise.all([f(),y()]).then(([e,t])=>{var s;console.log("Menu loaded:",e.data.length,"categories",t.data.length,"items"),r(e.data),i(t.data),a((null==(s=e.data[0])?void 0:s.id)??null)}).catch(e=>{console.error("Failed to load menu:",e),v("Unable to load the menu: "+e.message)})},[]),e.useEffect(()=>{if(!N)return w(null),void _([]);(async function(e){return u("/customer/me",{headers:{Authorization:`Bearer ${e}`}})})(N).then(e=>{w(e.customer.name||e.customer.phone)}).catch(()=>w(null)),g(N).then(e=>_(e.data)).catch(()=>_([]))},[N]);const L=e.useMemo(()=>l?s.filter(e=>e.category_id===l):s,[s,l]),q=e.useMemo(()=>m.reduce((e,t)=>{const r=t.modifiers.reduce((e,t)=>e+parseFloat(String(t.price)),0);return e+(parseFloat(String(t.item.base_price))+r)*t.quantity},0),[m]),E=async()=>{D(!0),T(""),A(null);try{const e=await async function(e){return u("/auth/customer/otp/request",{method:"POST",body:JSON.stringify({phone:e})})}(z);P(!0),v("OTP sent. Please check your SMS."),e.otp&&A(`Dev OTP: ${e.otp}`)}catch(e){T(e.message)}finally{D(!1)}},V=async()=>{D(!0),T("");try{const e=await async function(e){return u("/auth/customer/otp/verify",{method:"POST",body:JSON.stringify(e)})}({phone:z,otp:O});k(e.token),localStorage.setItem("online_token",e.token),P(!1),R(""),v("Logged in successfully.")}catch(e){T(e.message)}finally{D(!1)}},$=(e,t)=>{x(r=>{const s=[...r];return t<=0?(s.splice(e,1),s):(s[e]={...s[e],quantity:t},s)})};return N?h.jsxs("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",background:"#fff"},children:[h.jsx("header",{style:{position:"sticky",top:0,background:"#ffffff",borderBottom:"1px solid #e9ecef",zIndex:100,boxShadow:"0 2px 8px rgba(0,0,0,0.04)",display:"block",width:"100%"},children:h.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto",padding:"1rem 2rem",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[h.jsxs("a",{href:"/",style:{display:"flex",alignItems:"center",gap:"0.75rem",fontSize:"1.4rem",fontWeight:600,color:"#1c1e21",textDecoration:"none"},children:[h.jsx("img",{src:"/logo.svg",alt:"Bake & Grill",style:{width:"48px",height:"48px",borderRadius:"12px",display:"block"}}),h.jsx("span",{children:"Bake & Grill"})]}),h.jsxs("nav",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[S&&h.jsxs("span",{style:{fontSize:"0.9rem",color:"#636e72"},children:["Hi, ",S]}),h.jsx("button",{onClick:()=>{k(null),localStorage.removeItem("online_token")},style:{background:"transparent",color:"#1ba3b9",border:"1px solid #1ba3b9",padding:"0.5rem 1.25rem",borderRadius:"999px",fontSize:"0.9rem",fontWeight:500,cursor:"pointer"},children:"Logout"})]})]})}),h.jsxs("main",{className:"flex-1 grid gap-6 px-6 py-6 lg:grid-cols-12 max-w-7xl mx-auto w-full",style:{background:"#fafbfc",minHeight:"60vh"},children:[b&&h.jsx("div",{className:"lg:col-span-12 bg-red-50 border border-red-200 rounded-lg p-4 text-red-800",children:b}),h.jsxs("section",{className:"lg:col-span-3 space-y-3",children:[h.jsx("h2",{className:"text-sm font-semibold text-slate-500",children:"Categories"}),h.jsx("div",{className:"space-y-2",children:t.map(e=>h.jsx("button",{onClick:()=>a(e.id),className:"w-full rounded-lg px-4 py-3 text-left font-medium transition-all",style:{background:l===e.id?"var(--teal)":"white",color:l===e.id?"white":"var(--text)",border:"1px solid "+(l===e.id?"var(--teal)":"var(--border)")},children:e.name},e.id))})]}),h.jsxs("section",{className:"lg:col-span-5",children:[h.jsx("h2",{className:"text-2xl font-bold mb-6",style:{color:"var(--dark)"},children:"Our Menu"}),h.jsx("div",{className:"grid gap-4",children:L.map(e=>h.jsx("div",{onClick:()=>(e=>{o(e),c([])})(e),className:"menu-item-card",children:h.jsxs("div",{className:"flex items-start justify-between",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-lg font-semibold mb-1",style:{color:"var(--dark)"},children:e.name}),h.jsxs("p",{className:"text-xl font-bold",style:{color:"var(--teal)"},children:["MVR ","number"==typeof e.base_price?e.base_price.toFixed(2):e.base_price]})]}),h.jsx("button",{className:"btn-primary",style:{padding:"0.5rem 1.5rem",fontSize:"0.9rem"},children:"Add +"})]})},e.id))})]}),h.jsxs("section",{className:"lg:col-span-4 space-y-4",children:[h.jsxs("div",{className:"cart-card",children:[h.jsx("h2",{className:"text-lg font-bold mb-4",style:{color:"var(--dark)"},children:"Your Cart"}),0===m.length?h.jsx("p",{className:"mt-3 text-sm text-slate-500",children:"Your cart is empty."}):h.jsxs("div",{className:"mt-3 space-y-3",children:[m.map((e,t)=>h.jsxs("div",{className:"rounded-lg border border-slate-100 p-3",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("p",{className:"text-sm font-semibold text-slate-900",children:e.item.name}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>$(t,e.quantity-1),className:"h-6 w-6 rounded-full border border-slate-200 text-xs",children:"-"}),h.jsx("span",{className:"text-xs",children:e.quantity}),h.jsx("button",{onClick:()=>$(t,e.quantity+1),className:"h-6 w-6 rounded-full border border-slate-200 text-xs",children:"+"})]})]}),e.modifiers.length>0&&h.jsxs("p",{className:"mt-2 text-xs text-slate-500",children:["+ ",e.modifiers.map(e=>e.name).join(", ")]})]},`${e.item.id}-${t}`)),h.jsxs("div",{className:"flex items-center justify-between text-sm font-semibold",children:[h.jsx("span",{children:"Total"}),h.jsxs("span",{children:["MVR ","number"==typeof q?q.toFixed(2):q]})]})]}),h.jsx("textarea",{value:p,onChange:e=>j(e.target.value),placeholder:"Pickup notes (optional)",className:"mt-3 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",rows:3}),h.jsx("button",{onClick:async()=>{if(N&&0!==m.length){D(!0),v("");try{await async function(e,t){return u("/customer/orders",{method:"POST",headers:{Authorization:`Bearer ${e}`},body:JSON.stringify(t)})}(N,{customer_notes:p||void 0,type:"online_pickup",items:m.map(e=>({item_id:e.item.id,quantity:e.quantity,modifiers:e.modifiers.map(e=>({modifier_id:e.id}))}))}),x([]),j(""),v("Order placed! We will start preparing it.");const e=await g(N);_(e.data)}catch(e){v(e.message)}finally{D(!1)}}},disabled:0===m.length||W,className:"btn-primary w-full mt-4 text-lg",children:W?"Processing...":"Place Order üõí"}),b&&h.jsx("p",{className:"mt-2 text-xs text-emerald-600",children:b})]}),h.jsxs("div",{className:"cart-card",children:[h.jsx("h2",{className:"text-lg font-bold mb-4",style:{color:"var(--dark)"},children:"Order History"}),0===C.length?h.jsx("p",{className:"mt-3 text-sm text-slate-500",children:"No orders yet."}):h.jsx("div",{className:"mt-3 space-y-2",children:C.map(e=>h.jsxs("div",{className:"rounded-lg border border-slate-100 p-3 text-sm",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"font-semibold",children:e.order_number}),h.jsx("span",{className:"text-xs text-slate-500",children:e.status})]}),h.jsxs("p",{className:"text-xs text-slate-500",children:["MVR ",e.total?"number"==typeof e.total?e.total.toFixed(2):e.total:"0.00"]})]},e.id))})]})]})]}),h.jsxs("footer",{className:"footer",children:[h.jsxs("div",{className:"footer-content",children:[h.jsxs("div",{children:[h.jsx("h3",{children:"Bake & Grill Caf√©"}),h.jsx("p",{children:"Authentic Dhivehi cuisine, fresh pastries, and premium grills in Mal√©."})]}),h.jsxs("div",{children:[h.jsx("h3",{children:"Location"}),h.jsx("p",{children:"Majeedhee Magu, Mal√©, Maldives"}),h.jsx("p",{children:"Near ferry terminal"})]}),h.jsxs("div",{children:[h.jsx("h3",{children:"Quick Links"}),h.jsx("a",{href:"http://localhost:8000/menu",children:"Menu"}),h.jsx("a",{href:"http://localhost:8000/hours",children:"Opening Hours"}),h.jsx("a",{href:"http://localhost:8000/contact",children:"Contact Us"}),h.jsx("a",{href:"http://localhost:8000/privacy",children:"Privacy Policy"})]}),h.jsxs("div",{children:[h.jsx("h3",{children:"Contact"}),h.jsx("p",{children:"+960 9120011"}),h.jsx("p",{children:"hello@bakeandgrill.mv"}),h.jsx("a",{href:"https://wa.me/9609120011",target:"_blank",children:"WhatsApp"})]})]}),h.jsxs("div",{className:"footer-copyright",children:["¬© ",(new Date).getFullYear()," Bake & Grill. All rights reserved."]})]}),n&&h.jsx("div",{className:"fixed inset-0 z-20 flex items-center justify-center bg-black/40 px-4",children:h.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white p-6",children:[h.jsxs("div",{className:"flex items-start justify-between",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-semibold",children:n.name}),h.jsxs("p",{className:"text-sm text-slate-500",children:["MVR ","number"==typeof n.base_price?n.base_price.toFixed(2):n.base_price]})]}),h.jsx("button",{onClick:()=>o(null),className:"text-sm text-slate-400",children:"Close"})]}),n.modifiers&&n.modifiers.length>0?h.jsxs("div",{className:"mt-4 space-y-2",children:[h.jsx("p",{className:"text-sm font-semibold text-slate-700",children:"Modifiers"}),n.modifiers.map(e=>h.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-100 px-3 py-2 text-sm",children:[h.jsxs("span",{children:[e.name," (+MVR ","number"==typeof e.price?e.price.toFixed(2):e.price,")"]}),h.jsx("input",{type:"checkbox",checked:d.some(t=>t.id===e.id),onChange:()=>(e=>{c(t=>t.some(t=>t.id===e.id)?t.filter(t=>t.id!==e.id):[...t,e])})(e),className:"h-4 w-4"})]},e.id))]}):h.jsx("p",{className:"mt-4 text-sm text-slate-500",children:"No modifiers for this item."}),h.jsx("button",{onClick:()=>{n&&(x(e=>{const t=e.findIndex(e=>e.item.id===n.id&&e.modifiers.map(e=>e.id).join(",")===d.map(e=>e.id).join(","));if(t>=0){const r=[...e];return r[t]={...r[t],quantity:r[t].quantity+1},r}return[...e,{item:n,quantity:1,modifiers:d}]}),o(null),c([]))},className:"mt-5 w-full rounded-full px-6 py-3 text-base font-semibold text-white transition-all hover:shadow-lg",style:{background:"var(--teal)"},children:"Add to Cart"})]})})]}):h.jsxs("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",background:"#fff"},children:[h.jsx("header",{style:{position:"sticky",top:0,background:"#ffffff",borderBottom:"1px solid #e9ecef",zIndex:100,boxShadow:"0 2px 8px rgba(0,0,0,0.04)",display:"block",width:"100%"},children:h.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto",padding:"1rem 2rem",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[h.jsxs("a",{href:"/",style:{display:"flex",alignItems:"center",gap:"0.75rem",fontSize:"1.4rem",fontWeight:600,color:"#1c1e21",textDecoration:"none"},children:[h.jsx("img",{src:"/logo.svg",alt:"Bake & Grill",style:{width:"48px",height:"48px",borderRadius:"12px",display:"block"}}),h.jsx("span",{children:"Bake & Grill"})]}),h.jsxs("nav",{style:{display:"flex",gap:"2rem",alignItems:"center"},children:[h.jsx("a",{href:"/",style:{fontWeight:500,textDecoration:"none",color:"inherit"},children:"Home"}),h.jsx("a",{href:"/menu",style:{fontWeight:500,textDecoration:"none",color:"inherit"},children:"Menu"})]})]})}),h.jsx("div",{className:"flex-1 flex items-center justify-center px-4 py-12",style:{background:"linear-gradient(135deg, rgba(27, 163, 185, 0.1) 0%, rgba(184, 168, 144, 0.1) 100%)",backgroundSize:"400% 400%"},children:h.jsxs("div",{style:{maxWidth:"500px",width:"100%"},children:[h.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[h.jsx("div",{style:{fontSize:"3.5rem",marginBottom:"1rem"},children:"üçΩÔ∏è"}),h.jsx("h1",{style:{fontSize:"2.5rem",fontWeight:"700",color:"var(--dark)",marginBottom:"0.75rem"},children:"Order Fresh Food"}),h.jsx("p",{style:{fontSize:"1.1rem",color:"#636e72"},children:"Quick, easy, and delicious - delivered to you"})]}),h.jsxs("div",{style:{background:"white",borderRadius:"24px",padding:"2.5rem",boxShadow:"0 20px 60px rgba(0,0,0,0.12)",border:"1px solid rgba(27, 163, 185, 0.2)"},children:[h.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[h.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"600",color:"var(--dark)",marginBottom:"0.5rem"},children:"Sign In"}),h.jsx("p",{style:{color:"#636e72",fontSize:"0.95rem"},children:"We'll send you a verification code via SMS"})]}),h.jsxs("div",{style:{marginTop:"1.5rem"},children:[h.jsx("label",{style:{display:"block",fontWeight:"500",marginBottom:"0.75rem",color:"var(--dark)",fontSize:"0.95rem"},children:"üì± Phone Number"}),h.jsx("input",{value:z,onChange:e=>M(e.target.value),style:{width:"100%",padding:"1rem 1.25rem",border:"2px solid var(--border)",borderRadius:"12px",fontSize:"1rem",transition:"all 0.2s"},placeholder:"7820288 or +9607820288",onFocus:e=>e.target.style.borderColor="var(--teal)",onBlur:e=>e.target.style.borderColor="var(--border)"}),B&&h.jsxs("div",{style:{marginTop:"1.5rem"},children:[h.jsx("label",{style:{display:"block",fontWeight:"500",marginBottom:"0.75rem",color:"var(--dark)",fontSize:"0.95rem"},children:"üîê Verification Code"}),h.jsx("input",{value:O,onChange:e=>R(e.target.value),style:{width:"100%",padding:"1rem 1.25rem",border:"2px solid var(--border)",borderRadius:"12px",fontSize:"1.5rem",letterSpacing:"0.5rem",textAlign:"center",fontFamily:"monospace"},placeholder:"‚óè ‚óè ‚óè ‚óè ‚óè ‚óè",maxLength:6,onFocus:e=>e.target.style.borderColor="var(--teal)",onBlur:e=>e.target.style.borderColor="var(--border)"})]}),I&&h.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"#fff3cd",borderRadius:"8px",fontSize:"0.85rem",color:"#856404"},children:["üí° ",I]}),F&&h.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"#f8d7da",borderRadius:"8px",fontSize:"0.9rem",color:"#721c24"},children:["‚ö†Ô∏è ",F]}),b&&h.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"#d4edda",borderRadius:"8px",fontSize:"0.9rem",color:"#155724"},children:["‚úì ",b]}),h.jsx("div",{style:{marginTop:"2rem"},children:B?h.jsx("button",{onClick:V,disabled:W,className:"btn-primary w-full",style:{fontSize:"1.1rem",padding:"1.25rem"},children:W?"Verifying...":"Verify & Continue ‚Üí"}):h.jsx("button",{onClick:E,disabled:W,className:"btn-primary w-full",style:{fontSize:"1.1rem",padding:"1.25rem"},children:W?"Sending...":"Send Verification Code ‚Üí"})}),h.jsxs("p",{style:{textAlign:"center",marginTop:"1.5rem",fontSize:"0.85rem",color:"#95a5a6"},children:["üîí Your privacy is protected. See our ",h.jsx("a",{href:"/privacy",style:{color:"var(--teal)",textDecoration:"underline"},children:"privacy policy"})]})]})]})]})}),h.jsxs("footer",{className:"footer",children:[h.jsxs("div",{className:"footer-content",children:[h.jsxs("div",{children:[h.jsx("h3",{children:"Bake & Grill Caf√©"}),h.jsx("p",{children:"Authentic Dhivehi cuisine, fresh pastries, and premium grills in Mal√©."})]}),h.jsxs("div",{children:[h.jsx("h3",{children:"Location"}),h.jsx("p",{children:"Majeedhee Magu, Mal√©, Maldives"}),h.jsx("p",{children:"Near ferry terminal"})]}),h.jsxs("div",{children:[h.jsx("h3",{children:"Quick Links"}),h.jsx("a",{href:"http://localhost:8000/menu",children:"Menu"}),h.jsx("a",{href:"http://localhost:8000/hours",children:"Opening Hours"}),h.jsx("a",{href:"http://localhost:8000/contact",children:"Contact Us"}),h.jsx("a",{href:"http://localhost:8000/privacy",children:"Privacy Policy"})]}),h.jsxs("div",{children:[h.jsx("h3",{children:"Contact"}),h.jsx("p",{children:"+960 9120011"}),h.jsx("p",{children:"hello@bakeandgrill.mv"}),h.jsx("a",{href:"https://wa.me/9609120011",target:"_blank",children:"WhatsApp"})]})]}),h.jsxs("div",{className:"footer-copyright",children:["¬© ",(new Date).getFullYear()," Bake & Grill. All rights reserved."]})]})]})}x.createRoot(document.getElementById("root")).render(h.jsx(r.StrictMode,{children:h.jsx(j,{})}));
