import{r as e,a as t,R as s}from"./vendor-BXk_ma1u.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var l={exports:{}},a={},r=e,i=Symbol.for("react.element"),n=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,c=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function h(e,t,s){var l,a={},r=null,n=null;for(l in void 0!==s&&(r=""+s),void 0!==t.key&&(r=""+t.key),void 0!==t.ref&&(n=t.ref),t)o.call(t,l)&&!d.hasOwnProperty(l)&&(a[l]=t[l]);if(e&&e.defaultProps)for(l in t=e.defaultProps)void 0===a[l]&&(a[l]=t[l]);return{$$typeof:i,type:e,key:r,ref:n,props:a,_owner:c.current}}a.Fragment=n,a.jsx=h,a.jsxs=h,l.exports=a;var m=l.exports,x={},u=t;x.createRoot=u.createRoot,x.hydrateRoot=u.hydrateRoot;async function p(e,t={}){var s;const l=await fetch(`/api${e}`,{headers:{"Content-Type":"application/json",...t.headers},...t});if(!l.ok){const e=await l.json().catch(()=>({})),t=e.message??(null==(s=Object.values(e.errors??{})[0])?void 0:s[0])??"Request failed";throw new Error(t)}return await l.json()}async function f(){return p("/categories")}async function j(){return p("/items?available_only=1")}async function y(e){return p("/customer/orders",{headers:{Authorization:`Bearer ${e}`}})}function g(){const[t,s]=e.useState([]),[l,a]=e.useState([]),[r,i]=e.useState(null),[n,o]=e.useState(null),[c,d]=e.useState([]),[h,x]=e.useState([]),[u,g]=e.useState(""),[b,v]=e.useState(""),[N,k]=e.useState(()=>localStorage.getItem("online_token")),[w,S]=e.useState(null),[_,C]=e.useState([]),[O,M]=e.useState(""),[P,R]=e.useState(""),[B,q]=e.useState(!1),[A,F]=e.useState(null),[L,T]=e.useState(""),[E,H]=e.useState(!1);e.useEffect(()=>{Promise.all([f(),j()]).then(([e,t])=>{var l;console.log("Menu loaded:",e.data.length,"categories",t.data.length,"items"),s(e.data),a(t.data),i((null==(l=e.data[0])?void 0:l.id)??null)}).catch(e=>{console.error("Failed to load menu:",e),v("Unable to load the menu: "+e.message)})},[]),e.useEffect(()=>{if(!N)return S(null),void C([]);(async function(e){return p("/customer/me",{headers:{Authorization:`Bearer ${e}`}})})(N).then(e=>{S(e.customer.name||e.customer.phone)}).catch(()=>S(null)),y(N).then(e=>C(e.data)).catch(()=>C([]))},[N]);const D=e.useMemo(()=>r?l.filter(e=>e.category_id===r):l,[l,r]),G=e.useMemo(()=>h.reduce((e,t)=>{const s=t.modifiers.reduce((e,t)=>e+parseFloat(String(t.price)),0);return e+(parseFloat(String(t.item.base_price))+s)*t.quantity},0),[h]),I=async()=>{H(!0),T(""),F(null);try{const e=await async function(e){return p("/auth/customer/otp/request",{method:"POST",body:JSON.stringify({phone:e})})}(O);q(!0),v("OTP sent. Please check your SMS."),e.otp&&F(`Dev OTP: ${e.otp}`)}catch(e){T(e.message)}finally{H(!1)}},$=async()=>{H(!0),T("");try{const e=await async function(e){return p("/auth/customer/otp/verify",{method:"POST",body:JSON.stringify(e)})}({phone:O,otp:P});k(e.token),localStorage.setItem("online_token",e.token),q(!1),R(""),v("Logged in successfully.")}catch(e){T(e.message)}finally{H(!1)}},X=(e,t)=>{x(s=>{const l=[...s];return t<=0?(l.splice(e,1),l):(l[e]={...l[e],quantity:t},l)})};return N?m.jsxs("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",background:"#fff"},children:[m.jsx("header",{className:"header",children:m.jsxs("div",{className:"header-content",children:[m.jsxs("a",{href:"http://localhost:8000",className:"logo",children:[m.jsx("img",{src:"http://localhost:8000/logo.svg",alt:"Bake & Grill"}),m.jsx("span",{children:"Bake & Grill"})]}),m.jsxs("nav",{className:"nav",children:[m.jsx("a",{href:"http://localhost:8000/",children:"Home"}),m.jsx("a",{href:"http://localhost:8000/menu",children:"Menu"}),m.jsx("a",{href:"http://localhost:8000/hours",children:"Hours"}),m.jsx("a",{href:"http://localhost:8000/contact",children:"Contact"}),w&&m.jsxs("span",{style:{fontSize:"0.9rem",color:"#636e72"},children:["Hi, ",w]}),m.jsx("button",{onClick:()=>{k(null),localStorage.removeItem("online_token")},className:"logout-btn",children:"Logout"})]})]})}),m.jsxs("main",{className:"flex-1 grid gap-6 px-6 py-6 lg:grid-cols-12 max-w-7xl mx-auto w-full",style:{background:"#fafbfc",minHeight:"60vh"},children:[b&&m.jsx("div",{className:"lg:col-span-12 bg-red-50 border border-red-200 rounded-lg p-4 text-red-800",children:b}),m.jsxs("section",{className:"lg:col-span-3 space-y-3",children:[m.jsx("h2",{className:"text-sm font-semibold text-slate-500",children:"Categories"}),m.jsx("div",{className:"space-y-2",children:t.map(e=>m.jsx("button",{onClick:()=>i(e.id),className:"w-full rounded-lg px-4 py-3 text-left font-medium transition-all",style:{background:r===e.id?"var(--teal)":"white",color:r===e.id?"white":"var(--text)",border:"1px solid "+(r===e.id?"var(--teal)":"var(--border)")},children:e.name},e.id))})]}),m.jsxs("section",{className:"lg:col-span-5",children:[m.jsx("h2",{className:"text-2xl font-bold mb-6",style:{color:"var(--dark)"},children:"Our Menu"}),m.jsx("div",{className:"grid gap-4",children:D.map(e=>m.jsx("div",{onClick:()=>(e=>{o(e),d([])})(e),className:"menu-item-card",children:m.jsxs("div",{className:"flex items-start justify-between",children:[m.jsxs("div",{className:"flex-1",children:[m.jsx("h3",{className:"text-lg font-semibold mb-1",style:{color:"var(--dark)"},children:e.name}),m.jsxs("p",{className:"text-xl font-bold",style:{color:"var(--teal)"},children:["MVR ","number"==typeof e.base_price?e.base_price.toFixed(2):e.base_price]})]}),m.jsx("button",{className:"btn-primary",style:{padding:"0.5rem 1.5rem",fontSize:"0.9rem"},children:"Add +"})]})},e.id))})]}),m.jsxs("section",{className:"lg:col-span-4 space-y-4",children:[m.jsxs("div",{className:"cart-card",children:[m.jsx("h2",{className:"text-lg font-bold mb-4",style:{color:"var(--dark)"},children:"Your Cart"}),0===h.length?m.jsx("p",{className:"mt-3 text-sm text-slate-500",children:"Your cart is empty."}):m.jsxs("div",{className:"mt-3 space-y-3",children:[h.map((e,t)=>m.jsxs("div",{className:"rounded-lg border border-slate-100 p-3",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("p",{className:"text-sm font-semibold text-slate-900",children:e.item.name}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("button",{onClick:()=>X(t,e.quantity-1),className:"h-6 w-6 rounded-full border border-slate-200 text-xs",children:"-"}),m.jsx("span",{className:"text-xs",children:e.quantity}),m.jsx("button",{onClick:()=>X(t,e.quantity+1),className:"h-6 w-6 rounded-full border border-slate-200 text-xs",children:"+"})]})]}),e.modifiers.length>0&&m.jsxs("p",{className:"mt-2 text-xs text-slate-500",children:["+ ",e.modifiers.map(e=>e.name).join(", ")]})]},`${e.item.id}-${t}`)),m.jsxs("div",{className:"flex items-center justify-between text-sm font-semibold",children:[m.jsx("span",{children:"Total"}),m.jsxs("span",{children:["MVR ","number"==typeof G?G.toFixed(2):G]})]})]}),m.jsx("textarea",{value:u,onChange:e=>g(e.target.value),placeholder:"Pickup notes (optional)",className:"mt-3 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",rows:3}),m.jsx("button",{onClick:async()=>{if(N&&0!==h.length){H(!0),v("");try{await async function(e,t){return p("/customer/orders",{method:"POST",headers:{Authorization:`Bearer ${e}`},body:JSON.stringify(t)})}(N,{customer_notes:u||void 0,type:"online_pickup",items:h.map(e=>({item_id:e.item.id,quantity:e.quantity,modifiers:e.modifiers.map(e=>({modifier_id:e.id}))}))}),x([]),g(""),v("Order placed! We will start preparing it.");const e=await y(N);C(e.data)}catch(e){v(e.message)}finally{H(!1)}}},disabled:0===h.length||E,className:"btn-primary w-full mt-4 text-lg",children:E?"Processing...":"Place Order üõí"}),b&&m.jsx("p",{className:"mt-2 text-xs text-emerald-600",children:b})]}),m.jsxs("div",{className:"cart-card",children:[m.jsx("h2",{className:"text-lg font-bold mb-4",style:{color:"var(--dark)"},children:"Order History"}),0===_.length?m.jsx("p",{className:"mt-3 text-sm text-slate-500",children:"No orders yet."}):m.jsx("div",{className:"mt-3 space-y-2",children:_.map(e=>m.jsxs("div",{className:"rounded-lg border border-slate-100 p-3 text-sm",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"font-semibold",children:e.order_number}),m.jsx("span",{className:"text-xs text-slate-500",children:e.status})]}),m.jsxs("p",{className:"text-xs text-slate-500",children:["MVR ",e.total?"number"==typeof e.total?e.total.toFixed(2):e.total:"0.00"]})]},e.id))})]})]})]}),m.jsxs("footer",{className:"footer",children:[m.jsxs("div",{className:"footer-content",children:[m.jsxs("div",{children:[m.jsx("h3",{children:"Bake & Grill Caf√©"}),m.jsx("p",{children:"Authentic Dhivehi cuisine, fresh pastries, and premium grills in Mal√©."})]}),m.jsxs("div",{children:[m.jsx("h3",{children:"Location"}),m.jsx("p",{children:"Majeedhee Magu, Mal√©, Maldives"}),m.jsx("p",{children:"Near ferry terminal"})]}),m.jsxs("div",{children:[m.jsx("h3",{children:"Quick Links"}),m.jsx("a",{href:"http://localhost:8000/menu",children:"Menu"}),m.jsx("a",{href:"http://localhost:8000/hours",children:"Opening Hours"}),m.jsx("a",{href:"http://localhost:8000/contact",children:"Contact Us"}),m.jsx("a",{href:"http://localhost:8000/privacy",children:"Privacy Policy"})]}),m.jsxs("div",{children:[m.jsx("h3",{children:"Contact"}),m.jsx("p",{children:"+960 9120011"}),m.jsx("p",{children:"hello@bakeandgrill.mv"}),m.jsx("a",{href:"https://wa.me/9609120011",target:"_blank",children:"WhatsApp"})]})]}),m.jsxs("div",{className:"footer-copyright",children:["¬© ",(new Date).getFullYear()," Bake & Grill. All rights reserved."]})]}),n&&m.jsx("div",{className:"fixed inset-0 z-20 flex items-center justify-center bg-black/40 px-4",children:m.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white p-6",children:[m.jsxs("div",{className:"flex items-start justify-between",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-semibold",children:n.name}),m.jsxs("p",{className:"text-sm text-slate-500",children:["MVR ","number"==typeof n.base_price?n.base_price.toFixed(2):n.base_price]})]}),m.jsx("button",{onClick:()=>o(null),className:"text-sm text-slate-400",children:"Close"})]}),n.modifiers&&n.modifiers.length>0?m.jsxs("div",{className:"mt-4 space-y-2",children:[m.jsx("p",{className:"text-sm font-semibold text-slate-700",children:"Modifiers"}),n.modifiers.map(e=>m.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-100 px-3 py-2 text-sm",children:[m.jsxs("span",{children:[e.name," (+MVR ","number"==typeof e.price?e.price.toFixed(2):e.price,")"]}),m.jsx("input",{type:"checkbox",checked:c.some(t=>t.id===e.id),onChange:()=>(e=>{d(t=>t.some(t=>t.id===e.id)?t.filter(t=>t.id!==e.id):[...t,e])})(e),className:"h-4 w-4"})]},e.id))]}):m.jsx("p",{className:"mt-4 text-sm text-slate-500",children:"No modifiers for this item."}),m.jsx("button",{onClick:()=>{n&&(x(e=>{const t=e.findIndex(e=>e.item.id===n.id&&e.modifiers.map(e=>e.id).join(",")===c.map(e=>e.id).join(","));if(t>=0){const s=[...e];return s[t]={...s[t],quantity:s[t].quantity+1},s}return[...e,{item:n,quantity:1,modifiers:c}]}),o(null),d([]))},className:"mt-5 w-full rounded-full px-6 py-3 text-base font-semibold text-white transition-all hover:shadow-lg",style:{background:"var(--teal)"},children:"Add to Cart"})]})})]}):m.jsxs("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",background:"#fff"},children:[m.jsx("header",{className:"header",children:m.jsxs("div",{className:"header-content",children:[m.jsxs("a",{href:"http://localhost:8000",className:"logo",children:[m.jsx("img",{src:"http://localhost:8000/logo.svg",alt:"Bake & Grill"}),m.jsx("span",{children:"Bake & Grill"})]}),m.jsxs("nav",{className:"nav",children:[m.jsx("a",{href:"http://localhost:8000/",children:"Home"}),m.jsx("a",{href:"http://localhost:8000/menu",children:"Menu"}),m.jsx("a",{href:"http://localhost:8000/hours",children:"Hours"}),m.jsx("a",{href:"http://localhost:8000/contact",children:"Contact"})]})]})}),m.jsx("div",{className:"flex-1 flex items-center justify-center px-4 py-12",style:{background:"linear-gradient(135deg, rgba(27, 163, 185, 0.08), rgba(184, 168, 144, 0.08))"},children:m.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white p-8 shadow-lg border border-gray-200",children:[m.jsxs("div",{className:"text-center mb-6",children:[m.jsx("h1",{className:"text-3xl font-bold",style:{color:"var(--teal)"},children:"Bake & Grill"}),m.jsx("p",{className:"mt-2 text-base text-gray-600",children:"Sign in with your phone to order online"})]}),m.jsxs("div",{className:"mt-6 space-y-4",children:[m.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Phone (+960XXXXXXX)"}),m.jsx("input",{value:O,onChange:e=>M(e.target.value),className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm",placeholder:"+9607712345"}),B&&m.jsxs(m.Fragment,{children:[m.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"OTP"}),m.jsx("input",{value:P,onChange:e=>R(e.target.value),className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm tracking-widest",placeholder:"6-digit code"})]}),A&&m.jsx("p",{className:"text-xs text-amber-600",children:A}),L&&m.jsx("p",{className:"text-xs text-red-600",children:L}),b&&m.jsx("p",{className:"text-xs text-emerald-600",children:b}),m.jsx("div",{className:"flex gap-2",children:B?m.jsx("button",{onClick:$,disabled:E,className:"flex-1 rounded-full px-6 py-3 text-base font-semibold text-white disabled:opacity-70 transition-all hover:shadow-lg",style:{background:"var(--teal)"},children:"Verify OTP"}):m.jsx("button",{onClick:I,disabled:E,className:"flex-1 rounded-full px-6 py-3 text-base font-semibold text-white disabled:opacity-70 transition-all hover:shadow-lg",style:{background:"var(--teal)"},children:"Send OTP"})})]})]})}),m.jsxs("footer",{className:"footer",children:[m.jsxs("div",{className:"footer-content",children:[m.jsxs("div",{children:[m.jsx("h3",{children:"Bake & Grill Caf√©"}),m.jsx("p",{children:"Authentic Dhivehi cuisine, fresh pastries, and premium grills in Mal√©."})]}),m.jsxs("div",{children:[m.jsx("h3",{children:"Location"}),m.jsx("p",{children:"Majeedhee Magu, Mal√©, Maldives"}),m.jsx("p",{children:"Near ferry terminal"})]}),m.jsxs("div",{children:[m.jsx("h3",{children:"Quick Links"}),m.jsx("a",{href:"http://localhost:8000/menu",children:"Menu"}),m.jsx("a",{href:"http://localhost:8000/hours",children:"Opening Hours"}),m.jsx("a",{href:"http://localhost:8000/contact",children:"Contact Us"}),m.jsx("a",{href:"http://localhost:8000/privacy",children:"Privacy Policy"})]}),m.jsxs("div",{children:[m.jsx("h3",{children:"Contact"}),m.jsx("p",{children:"+960 9120011"}),m.jsx("p",{children:"hello@bakeandgrill.mv"}),m.jsx("a",{href:"https://wa.me/9609120011",target:"_blank",children:"WhatsApp"})]})]}),m.jsxs("div",{className:"footer-copyright",children:["¬© ",(new Date).getFullYear()," Bake & Grill. All rights reserved."]})]})]})}x.createRoot(document.getElementById("root")).render(m.jsx(s.StrictMode,{children:m.jsx(g,{})}));
